<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="keywords" content="Alex, Bikfalvi, personal, site"/>
<meta name="description" content="Alex Bikfalvi personal web site"/>
<meta name="robots" content="index, follow"/>

<link href="../../../../images/icon.ico" rel="shortcut icon"/>
<link href="../../../../style/style.css" rel="stylesheet" title="Silver stylesheet" type="text/css"/>

<title>Alex Bikfalvi - SimStream Documentation</title>

<script type="text/javascript" src="../../../../script/ga.js"></script>

</head>

<body>
<div id="content">
  
<div id="header">
<p class="hidden">Alex Bikfalvi</p>
</div>

<div id="back">

<div id="main-menu">
<ul id="main-menu-list" class="menu">
<li><a href="../../../../" accesskey="H"><span class="accesskey">H</span>ome</a></li>
<li><a href="../../../../bio.html" accesskey="B"><span class="accesskey">B</span>io</a></li>
<li><a href="../../../../contact.html" accesskey="C"><span class="accesskey">C</span>ontact</a></li>
<li><a href="../../../../research.html" accesskey="R"><span class="accesskey">R</span>esearch</a></li>
<li id="main-menu-selection"><a href="../../../../projects.html" accesskey="J">Pro<span class="accesskey">j</span>ects</a></li>
<li><a href="../../../../pubs.html" accesskey="P"><span class="accesskey">P</span>ublications</a></li>
<li><a href="../../../../teaching.html" accesskey="T"><span class="accesskey">T</span>eaching</a></li>
<li><a href="../../../../events.html" accesskey="E"><span class="accesskey">E</span>vents</a></li>
</ul>
</div>

<div id="path">
<p>You are here: <a href="../../../../index.html">Home</a> &gt; <a href="../../../../projects.html">Projects</a> &gt; <a href="../../index.html">SimStream</a> &gt; Documentation</p>
</div>

<div id="main-content">

<h1 class="title">SimStream Documentation</h1>

<!-- Generated by Doxygen 1.7.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>Gamma.cpp</h1>  </div>
</div>
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#include &quot;Headers.h&quot;</span>
<a name="l00002"></a>00002 <span class="preprocessor">#include &quot;Gamma.h&quot;</span>
<a name="l00003"></a>00003 <span class="preprocessor">#include &quot;Psi.h&quot;</span>
<a name="l00004"></a>00004 <span class="preprocessor">#include &quot;Chebyshev.h&quot;</span>
<a name="l00005"></a>00005 <span class="preprocessor">#include &quot;Exp.h&quot;</span>
<a name="l00006"></a>00006 
<a name="l00007"></a>00007 <span class="keyword">static</span> <span class="keyword">struct </span>{<span class="keywordtype">int</span> n; <span class="keywordtype">double</span> f; <span class="keywordtype">long</span> i; } fact_table[MATH_SF_FACT_NMAX + 1] = {
<a name="l00008"></a>00008     { 0,  1.0,     1L     },
<a name="l00009"></a>00009     { 1,  1.0,     1L     },
<a name="l00010"></a>00010     { 2,  2.0,     2L     },
<a name="l00011"></a>00011     { 3,  6.0,     6L     },
<a name="l00012"></a>00012     { 4,  24.0,    24L    },
<a name="l00013"></a>00013     { 5,  120.0,   120L   },
<a name="l00014"></a>00014     { 6,  720.0,   720L   },
<a name="l00015"></a>00015     { 7,  5040.0,  5040L  },
<a name="l00016"></a>00016     { 8,  40320.0, 40320L },
<a name="l00017"></a>00017 
<a name="l00018"></a>00018     { 9,  362880.0,     362880L    },
<a name="l00019"></a>00019     { 10, 3628800.0,    3628800L   },
<a name="l00020"></a>00020     { 11, 39916800.0,   39916800L  },
<a name="l00021"></a>00021     { 12, 479001600.0,  479001600L },
<a name="l00022"></a>00022 
<a name="l00023"></a>00023     { 13, 6227020800.0,                               0 },
<a name="l00024"></a>00024     { 14, 87178291200.0,                              0 },
<a name="l00025"></a>00025     { 15, 1307674368000.0,                            0 },
<a name="l00026"></a>00026     { 16, 20922789888000.0,                           0 },
<a name="l00027"></a>00027     { 17, 355687428096000.0,                          0 },
<a name="l00028"></a>00028     { 18, 6402373705728000.0,                         0 },
<a name="l00029"></a>00029     { 19, 121645100408832000.0,                       0 },
<a name="l00030"></a>00030     { 20, 2432902008176640000.0,                      0 },
<a name="l00031"></a>00031     { 21, 51090942171709440000.0,                     0 },
<a name="l00032"></a>00032     { 22, 1124000727777607680000.0,                   0 },
<a name="l00033"></a>00033     { 23, 25852016738884976640000.0,                  0 },
<a name="l00034"></a>00034     { 24, 620448401733239439360000.0,                 0 },
<a name="l00035"></a>00035     { 25, 15511210043330985984000000.0,               0 },
<a name="l00036"></a>00036     { 26, 403291461126605635584000000.0,              0 },
<a name="l00037"></a>00037     { 27, 10888869450418352160768000000.0,            0 },
<a name="l00038"></a>00038     { 28, 304888344611713860501504000000.0,           0 },
<a name="l00039"></a>00039     { 29, 8841761993739701954543616000000.0,          0 },
<a name="l00040"></a>00040     { 30, 265252859812191058636308480000000.0,        0 },
<a name="l00041"></a>00041     { 31, 8222838654177922817725562880000000.0,       0 },
<a name="l00042"></a>00042     { 32, 263130836933693530167218012160000000.0,     0 },
<a name="l00043"></a>00043     { 33, 8683317618811886495518194401280000000.0,    0 },
<a name="l00044"></a>00044     { 34, 2.95232799039604140847618609644e38,  0 },
<a name="l00045"></a>00045     { 35, 1.03331479663861449296666513375e40,  0 },
<a name="l00046"></a>00046     { 36, 3.71993326789901217467999448151e41,  0 },
<a name="l00047"></a>00047     { 37, 1.37637530912263450463159795816e43,  0 },
<a name="l00048"></a>00048     { 38, 5.23022617466601111760007224100e44,  0 },
<a name="l00049"></a>00049     { 39, 2.03978820811974433586402817399e46,  0 },
<a name="l00050"></a>00050     { 40, 8.15915283247897734345611269600e47,  0 },
<a name="l00051"></a>00051     { 41, 3.34525266131638071081700620534e49,  0 },
<a name="l00052"></a>00052     { 42, 1.40500611775287989854314260624e51,  0 },
<a name="l00053"></a>00053     { 43, 6.04152630633738356373551320685e52,  0 },
<a name="l00054"></a>00054     { 44, 2.65827157478844876804362581101e54,  0 },
<a name="l00055"></a>00055     { 45, 1.19622220865480194561963161496e56,  0 },
<a name="l00056"></a>00056     { 46, 5.50262215981208894985030542880e57,  0 },
<a name="l00057"></a>00057     { 47, 2.58623241511168180642964355154e59,  0 },
<a name="l00058"></a>00058     { 48, 1.24139155925360726708622890474e61,  0 },
<a name="l00059"></a>00059     { 49, 6.08281864034267560872252163321e62,  0 },
<a name="l00060"></a>00060     { 50, 3.04140932017133780436126081661e64,  0 },
<a name="l00061"></a>00061     { 51, 1.55111875328738228022424301647e66,  0 },
<a name="l00062"></a>00062     { 52, 8.06581751709438785716606368564e67,  0 },
<a name="l00063"></a>00063     { 53, 4.27488328406002556429801375339e69,  0 },
<a name="l00064"></a>00064     { 54, 2.30843697339241380472092742683e71,  0 },
<a name="l00065"></a>00065     { 55, 1.26964033536582759259651008476e73,  0 },
<a name="l00066"></a>00066     { 56, 7.10998587804863451854045647464e74,  0 },
<a name="l00067"></a>00067     { 57, 4.05269195048772167556806019054e76,  0 },
<a name="l00068"></a>00068     { 58, 2.35056133128287857182947491052e78,  0 },
<a name="l00069"></a>00069     { 59, 1.38683118545689835737939019720e80,  0 },
<a name="l00070"></a>00070     { 60, 8.32098711274139014427634118320e81,  0 },
<a name="l00071"></a>00071     { 61, 5.07580213877224798800856812177e83,  0 },
<a name="l00072"></a>00072     { 62, 3.14699732603879375256531223550e85,  0 },
<a name="l00073"></a>00073     { 63, 1.982608315404440064116146708360e87,  0 },
<a name="l00074"></a>00074     { 64, 1.268869321858841641034333893350e89,  0 },
<a name="l00075"></a>00075     { 65, 8.247650592082470666723170306800e90,  0 },
<a name="l00076"></a>00076     { 66, 5.443449390774430640037292402480e92,  0 },
<a name="l00077"></a>00077     { 67, 3.647111091818868528824985909660e94,  0 },
<a name="l00078"></a>00078     { 68, 2.480035542436830599600990418570e96,  0 },
<a name="l00079"></a>00079     { 69, 1.711224524281413113724683388810e98,  0 },
<a name="l00080"></a>00080     { 70, 1.197857166996989179607278372170e100,  0 },
<a name="l00081"></a>00081     { 71, 8.504785885678623175211676442400e101,  0 },
<a name="l00082"></a>00082     { 72, 6.123445837688608686152407038530e103,  0 },
<a name="l00083"></a>00083     { 73, 4.470115461512684340891257138130e105,  0 },
<a name="l00084"></a>00084     { 74, 3.307885441519386412259530282210e107,  0 },
<a name="l00085"></a>00085     { 75, 2.480914081139539809194647711660e109,  0 },
<a name="l00086"></a>00086     { 76, 1.885494701666050254987932260860e111,  0 },
<a name="l00087"></a>00087     { 77, 1.451830920282858696340707840860e113,  0 },
<a name="l00088"></a>00088     { 78, 1.132428117820629783145752115870e115,  0 },
<a name="l00089"></a>00089     { 79, 8.946182130782975286851441715400e116,  0 },
<a name="l00090"></a>00090     { 80, 7.156945704626380229481153372320e118,  0 },
<a name="l00091"></a>00091     { 81, 5.797126020747367985879734231580e120,  0 },
<a name="l00092"></a>00092     { 82, 4.753643337012841748421382069890e122,  0 },
<a name="l00093"></a>00093     { 83, 3.945523969720658651189747118010e124,  0 },
<a name="l00094"></a>00094     { 84, 3.314240134565353266999387579130e126,  0 },
<a name="l00095"></a>00095     { 85, 2.817104114380550276949479442260e128,  0 },
<a name="l00096"></a>00096     { 86, 2.422709538367273238176552320340e130,  0 },
<a name="l00097"></a>00097     { 87, 2.107757298379527717213600518700e132,  0 },
<a name="l00098"></a>00098     { 88, 1.854826422573984391147968456460e134,  0 },
<a name="l00099"></a>00099     { 89, 1.650795516090846108121691926250e136,  0 },
<a name="l00100"></a>00100     { 90, 1.485715964481761497309522733620e138,  0 },
<a name="l00101"></a>00101     { 91, 1.352001527678402962551665687590e140,  0 },
<a name="l00102"></a>00102     { 92, 1.243841405464130725547532432590e142,  0 },
<a name="l00103"></a>00103     { 93, 1.156772507081641574759205162310e144,  0 },
<a name="l00104"></a>00104     { 94, 1.087366156656743080273652852570e146,  0 },
<a name="l00105"></a>00105     { 95, 1.032997848823905926259970209940e148,  0 },
<a name="l00106"></a>00106     { 96, 9.916779348709496892095714015400e149,  0 },
<a name="l00107"></a>00107     { 97, 9.619275968248211985332842594960e151,  0 },
<a name="l00108"></a>00108     { 98, 9.426890448883247745626185743100e153,  0 },
<a name="l00109"></a>00109     { 99, 9.332621544394415268169923885600e155,  0 },
<a name="l00110"></a>00110     { 100, 9.33262154439441526816992388563e157,  0 },
<a name="l00111"></a>00111     { 101, 9.42594775983835942085162312450e159,  0 },
<a name="l00112"></a>00112     { 102, 9.61446671503512660926865558700e161,  0 },
<a name="l00113"></a>00113     { 103, 9.90290071648618040754671525458e163,  0 },
<a name="l00114"></a>00114     { 104, 1.02990167451456276238485838648e166,  0 },
<a name="l00115"></a>00115     { 105, 1.08139675824029090050410130580e168,  0 },
<a name="l00116"></a>00116     { 106, 1.146280563734708354534347384148e170,  0 },
<a name="l00117"></a>00117     { 107, 1.226520203196137939351751701040e172,  0 },
<a name="l00118"></a>00118     { 108, 1.324641819451828974499891837120e174,  0 },
<a name="l00119"></a>00119     { 109, 1.443859583202493582204882102460e176,  0 },
<a name="l00120"></a>00120     { 110, 1.588245541522742940425370312710e178,  0 },
<a name="l00121"></a>00121     { 111, 1.762952551090244663872161047110e180,  0 },
<a name="l00122"></a>00122     { 112, 1.974506857221074023536820372760e182,  0 },
<a name="l00123"></a>00123     { 113, 2.231192748659813646596607021220e184,  0 },
<a name="l00124"></a>00124     { 114, 2.543559733472187557120132004190e186,  0 },
<a name="l00125"></a>00125     { 115, 2.925093693493015690688151804820e188,  0 },
<a name="l00126"></a>00126     { 116, 3.393108684451898201198256093590e190,  0 },
<a name="l00127"></a>00127     { 117, 3.96993716080872089540195962950e192,  0 },
<a name="l00128"></a>00128     { 118, 4.68452584975429065657431236281e194,  0 },
<a name="l00129"></a>00129     { 119, 5.57458576120760588132343171174e196,  0 },
<a name="l00130"></a>00130     { 120, 6.68950291344912705758811805409e198,  0 },
<a name="l00131"></a>00131     { 121, 8.09429852527344373968162284545e200,  0 },
<a name="l00132"></a>00132     { 122, 9.87504420083360136241157987140e202,  0 },
<a name="l00133"></a>00133     { 123, 1.21463043670253296757662432419e205,  0 },
<a name="l00134"></a>00134     { 124, 1.50614174151114087979501416199e207,  0 },
<a name="l00135"></a>00135     { 125, 1.88267717688892609974376770249e209,  0 },
<a name="l00136"></a>00136     { 126, 2.37217324288004688567714730514e211,  0 },
<a name="l00137"></a>00137     { 127, 3.01266001845765954480997707753e213,  0 },
<a name="l00138"></a>00138     { 128, 3.85620482362580421735677065923e215,  0 },
<a name="l00139"></a>00139     { 129, 4.97450422247728744039023415041e217,  0 },
<a name="l00140"></a>00140     { 130, 6.46685548922047367250730439554e219,  0 },
<a name="l00141"></a>00141     { 131, 8.47158069087882051098456875820e221,  0 },
<a name="l00142"></a>00142     { 132, 1.11824865119600430744996307608e224,  0 },
<a name="l00143"></a>00143     { 133, 1.48727070609068572890845089118e226,  0 },
<a name="l00144"></a>00144     { 134, 1.99294274616151887673732419418e228,  0 },
<a name="l00145"></a>00145     { 135, 2.69047270731805048359538766215e230,  0 },
<a name="l00146"></a>00146     { 136, 3.65904288195254865768972722052e232,  0 },
<a name="l00147"></a>00147     { 137, 5.01288874827499166103492629211e234,  0 },
<a name="l00148"></a>00148     { 138, 6.91778647261948849222819828311e236,  0 },
<a name="l00149"></a>00149     { 139, 9.61572319694108900419719561353e238,  0 },
<a name="l00150"></a>00150     { 140, 1.34620124757175246058760738589e241,  0 },
<a name="l00151"></a>00151     { 141, 1.89814375907617096942852641411e243,  0 },
<a name="l00152"></a>00152     { 142, 2.69536413788816277658850750804e245,  0 },
<a name="l00153"></a>00153     { 143, 3.85437071718007277052156573649e247,  0 },
<a name="l00154"></a>00154     { 144, 5.55029383273930478955105466055e249,  0 },
<a name="l00155"></a>00155     { 145, 8.04792605747199194484902925780e251,  0 },
<a name="l00156"></a>00156     { 146, 1.17499720439091082394795827164e254,  0 },
<a name="l00157"></a>00157     { 147, 1.72724589045463891120349865931e256,  0 },
<a name="l00158"></a>00158     { 148, 2.55632391787286558858117801578e258,  0 },
<a name="l00159"></a>00159     { 149, 3.80892263763056972698595524351e260,  0 },
<a name="l00160"></a>00160     { 150, 5.71338395644585459047893286526e262,  0 },
<a name="l00161"></a>00161     { 151, 8.62720977423324043162318862650e264,  0 },
<a name="l00162"></a>00162     { 152, 1.31133588568345254560672467123e267,  0 },
<a name="l00163"></a>00163     { 153, 2.00634390509568239477828874699e269,  0 },
<a name="l00164"></a>00164     { 154, 3.08976961384735088795856467036e271,  0 },
<a name="l00165"></a>00165     { 155, 4.78914290146339387633577523906e273,  0 },
<a name="l00166"></a>00166     { 156, 7.47106292628289444708380937294e275,  0 },
<a name="l00167"></a>00167     { 157, 1.17295687942641442819215807155e278,  0 },
<a name="l00168"></a>00168     { 158, 1.85327186949373479654360975305e280,  0 },
<a name="l00169"></a>00169     { 159, 2.94670227249503832650433950735e282,  0 },
<a name="l00170"></a>00170     { 160, 4.71472363599206132240694321176e284,  0 },
<a name="l00171"></a>00171     { 161, 7.59070505394721872907517857094e286,  0 },
<a name="l00172"></a>00172     { 162, 1.22969421873944943411017892849e289,  0 },
<a name="l00173"></a>00173     { 163, 2.00440157654530257759959165344e291,  0 },
<a name="l00174"></a>00174     { 164, 3.28721858553429622726333031164e293,  0 },
<a name="l00175"></a>00175     { 165, 5.42391066613158877498449501421e295,  0 },
<a name="l00176"></a>00176     { 166, 9.00369170577843736647426172359e297,  0 },
<a name="l00177"></a>00177     { 167, 1.50361651486499904020120170784e300,  0 },
<a name="l00178"></a>00178     { 168, 2.52607574497319838753801886917e302,  0 },
<a name="l00179"></a>00179     { 169, 4.26906800900470527493925188890e304,  0 },
<a name="l00180"></a>00180     { 170, 7.25741561530799896739672821113e306,  0 },
<a name="l00181"></a>00181 
<a name="l00182"></a>00182     <span class="comment">/*</span>
<a name="l00183"></a>00183 <span class="comment">    { 171, 1.24101807021766782342484052410e309,  0 },</span>
<a name="l00184"></a>00184 <span class="comment">    { 172, 2.13455108077438865629072570146e311,  0 },</span>
<a name="l00185"></a>00185 <span class="comment">    { 173, 3.69277336973969237538295546352e313,  0 },</span>
<a name="l00186"></a>00186 <span class="comment">    { 174, 6.42542566334706473316634250653e315,  0 },</span>
<a name="l00187"></a>00187 <span class="comment">    { 175, 1.12444949108573632830410993864e318,  0 },</span>
<a name="l00188"></a>00188 <span class="comment">    { 176, 1.97903110431089593781523349201e320,  0 },</span>
<a name="l00189"></a>00189 <span class="comment">    { 177, 3.50288505463028580993296328086e322,  0 },</span>
<a name="l00190"></a>00190 <span class="comment">    { 178, 6.23513539724190874168067463993e324,  0 },</span>
<a name="l00191"></a>00191 <span class="comment">    { 179, 1.11608923610630166476084076055e327,  0 },</span>
<a name="l00192"></a>00192 <span class="comment">    { 180, 2.00896062499134299656951336898e329,  0 },</span>
<a name="l00193"></a>00193 <span class="comment">    { 181, 3.63621873123433082379081919786e331,  0 },</span>
<a name="l00194"></a>00194 <span class="comment">    { 182, 6.61791809084648209929929094011e333,  0 },</span>
<a name="l00195"></a>00195 <span class="comment">    { 183, 1.21107901062490622417177024204e336,  0 },</span>
<a name="l00196"></a>00196 <span class="comment">    { 184, 2.22838537954982745247605724535e338,  0 },</span>
<a name="l00197"></a>00197 <span class="comment">    { 185, 4.12251295216718078708070590390e340,  0 },</span>
<a name="l00198"></a>00198 <span class="comment">    { 186, 7.66787409103095626397011298130e342,  0 },</span>
<a name="l00199"></a>00199 <span class="comment">    { 187, 1.43389245502278882136241112750e345,  0 },</span>
<a name="l00200"></a>00200 <span class="comment">    { 188, 2.69571781544284298416133291969e347,  0 },</span>
<a name="l00201"></a>00201 <span class="comment">    { 189, 5.09490667118697324006491921822e349,  0 },</span>
<a name="l00202"></a>00202 <span class="comment">    { 190, 9.68032267525524915612334651460e351,  0 },</span>
<a name="l00203"></a>00203 <span class="comment">    { 191, 1.84894163097375258881955918429e354,  0 },</span>
<a name="l00204"></a>00204 <span class="comment">    { 192, 3.54996793146960497053355363384e356,  0 },</span>
<a name="l00205"></a>00205 <span class="comment">    { 193, 6.85143810773633759312975851330e358,  0 },</span>
<a name="l00206"></a>00206 <span class="comment">    { 194, 1.32917899290084949306717315158e361,  0 },</span>
<a name="l00207"></a>00207 <span class="comment">    { 195, 2.59189903615665651148098764559e363,  0 },</span>
<a name="l00208"></a>00208 <span class="comment">    { 196, 5.08012211086704676250273578535e365,  0 },</span>
<a name="l00209"></a>00209 <span class="comment">    { 197, 1.00078405584080821221303894971e368,  0 },</span>
<a name="l00210"></a>00210 <span class="comment">    { 198, 1.98155243056480026018181712043e370,  0 },</span>
<a name="l00211"></a>00211 <span class="comment">    { 199, 3.94328933682395251776181606966e372,  0 },</span>
<a name="l00212"></a>00212 <span class="comment">    { 200, 7.88657867364790503552363213932e374,  0 }</span>
<a name="l00213"></a>00213 <span class="comment">    */</span>
<a name="l00214"></a>00214 };
<a name="l00215"></a>00215 
<a name="l00216"></a>00216 <span class="comment">/* Chebyshev coefficients for Gamma*(3/4(t+1)+1/2), -1&lt;t&lt;1</span>
<a name="l00217"></a>00217 <span class="comment"> */</span>
<a name="l00218"></a>00218 <span class="keyword">static</span> <span class="keywordtype">double</span> gstar_a_data[30] = {
<a name="l00219"></a>00219   2.16786447866463034423060819465,
<a name="l00220"></a>00220  -0.05533249018745584258035832802,
<a name="l00221"></a>00221   0.01800392431460719960888319748,
<a name="l00222"></a>00222  -0.00580919269468937714480019814,
<a name="l00223"></a>00223   0.00186523689488400339978881560,
<a name="l00224"></a>00224  -0.00059746524113955531852595159,
<a name="l00225"></a>00225   0.00019125169907783353925426722,
<a name="l00226"></a>00226  -0.00006124996546944685735909697,
<a name="l00227"></a>00227   0.00001963889633130842586440945,
<a name="l00228"></a>00228  -6.3067741254637180272515795142e-06,
<a name="l00229"></a>00229   2.0288698405861392526872789863e-06,
<a name="l00230"></a>00230  -6.5384896660838465981983750582e-07,
<a name="l00231"></a>00231   2.1108698058908865476480734911e-07,
<a name="l00232"></a>00232  -6.8260714912274941677892994580e-08,
<a name="l00233"></a>00233   2.2108560875880560555583978510e-08,
<a name="l00234"></a>00234  -7.1710331930255456643627187187e-09,
<a name="l00235"></a>00235   2.3290892983985406754602564745e-09,
<a name="l00236"></a>00236  -7.5740371598505586754890405359e-10,
<a name="l00237"></a>00237   2.4658267222594334398525312084e-10,
<a name="l00238"></a>00238  -8.0362243171659883803428749516e-11,
<a name="l00239"></a>00239   2.6215616826341594653521346229e-11,
<a name="l00240"></a>00240  -8.5596155025948750540420068109e-12,
<a name="l00241"></a>00241   2.7970831499487963614315315444e-12,
<a name="l00242"></a>00242  -9.1471771211886202805502562414e-13,
<a name="l00243"></a>00243   2.9934720198063397094916415927e-13,
<a name="l00244"></a>00244  -9.8026575909753445931073620469e-14,
<a name="l00245"></a>00245   3.2116773667767153777571410671e-14,
<a name="l00246"></a>00246  -1.0518035333878147029650507254e-14,
<a name="l00247"></a>00247   3.4144405720185253938994854173e-15,
<a name="l00248"></a>00248  -1.0115153943081187052322643819e-15
<a name="l00249"></a>00249 };
<a name="l00250"></a>00250 
<a name="l00251"></a>00251 
<a name="l00252"></a>00252 <span class="comment">/* Chebyshev coefficients for</span>
<a name="l00253"></a>00253 <span class="comment"> * x^2(Gamma*(x) - 1 - 1/(12x)), x = 4(t+1)+2, -1 &lt; t &lt; 1</span>
<a name="l00254"></a>00254 <span class="comment"> */</span>
<a name="l00255"></a>00255 <span class="keyword">static</span> <span class="keywordtype">double</span> gstar_b_data[] = {
<a name="l00256"></a>00256   0.0057502277273114339831606096782,
<a name="l00257"></a>00257   0.0004496689534965685038254147807,
<a name="l00258"></a>00258  -0.0001672763153188717308905047405,
<a name="l00259"></a>00259   0.0000615137014913154794776670946,
<a name="l00260"></a>00260  -0.0000223726551711525016380862195,
<a name="l00261"></a>00261   8.0507405356647954540694800545e-06,
<a name="l00262"></a>00262  -2.8671077107583395569766746448e-06,
<a name="l00263"></a>00263   1.0106727053742747568362254106e-06,
<a name="l00264"></a>00264  -3.5265558477595061262310873482e-07,
<a name="l00265"></a>00265   1.2179216046419401193247254591e-07,
<a name="l00266"></a>00266  -4.1619640180795366971160162267e-08,
<a name="l00267"></a>00267   1.4066283500795206892487241294e-08,
<a name="l00268"></a>00268  -4.6982570380537099016106141654e-09,
<a name="l00269"></a>00269   1.5491248664620612686423108936e-09,
<a name="l00270"></a>00270  -5.0340936319394885789686867772e-10,
<a name="l00271"></a>00271   1.6084448673736032249959475006e-10,
<a name="l00272"></a>00272  -5.0349733196835456497619787559e-11,
<a name="l00273"></a>00273   1.5357154939762136997591808461e-11,
<a name="l00274"></a>00274  -4.5233809655775649997667176224e-12,
<a name="l00275"></a>00275   1.2664429179254447281068538964e-12,
<a name="l00276"></a>00276  -3.2648287937449326771785041692e-13,
<a name="l00277"></a>00277   7.1528272726086133795579071407e-14,
<a name="l00278"></a>00278  -9.4831735252566034505739531258e-15,
<a name="l00279"></a>00279  -2.3124001991413207293120906691e-15,
<a name="l00280"></a>00280   2.8406613277170391482590129474e-15,
<a name="l00281"></a>00281  -1.7245370321618816421281770927e-15,
<a name="l00282"></a>00282   8.6507923128671112154695006592e-16,
<a name="l00283"></a>00283  -3.9506563665427555895391869919e-16,
<a name="l00284"></a>00284   1.6779342132074761078792361165e-16,
<a name="l00285"></a>00285  -6.0483153034414765129837716260e-17
<a name="l00286"></a>00286 };
<a name="l00287"></a>00287 
<a name="l00288"></a>00288 
<a name="l00289"></a>00289 <span class="comment">/* coefficients for gamma=7, kmax=8  Lanczos method */</span>
<a name="l00290"></a>00290 <span class="keyword">static</span> <span class="keywordtype">double</span> lanczos_7_c[9] = {
<a name="l00291"></a>00291   0.99999999999980993227684700473478,
<a name="l00292"></a>00292   676.520368121885098567009190444019,
<a name="l00293"></a>00293  -1259.13921672240287047156078755283,
<a name="l00294"></a>00294   771.3234287776530788486528258894,
<a name="l00295"></a>00295  -176.61502916214059906584551354,
<a name="l00296"></a>00296   12.507343278686904814458936853,
<a name="l00297"></a>00297  -0.13857109526572011689554707,
<a name="l00298"></a>00298   9.984369578019570859563e-6,
<a name="l00299"></a>00299   1.50563273514931155834e-7
<a name="l00300"></a>00300 };
<a name="l00301"></a>00301 
<a name="l00302"></a>00302 
<a name="l00303"></a>00303 <span class="comment">/* Lanczos method for real x &gt; 0;</span>
<a name="l00304"></a>00304 <span class="comment"> * gamma=7, truncated at 1/(z+8) </span>
<a name="l00305"></a>00305 <span class="comment"> * [J. SIAM Numer. Anal, Ser. B, 1 (1964) 86]</span>
<a name="l00306"></a>00306 <span class="comment"> */</span>
<a name="l00307"></a>00307 <span class="keyword">static</span> <span class="keywordtype">int</span> LnGammaLanczos(<span class="keywordtype">double</span> x, <a class="code" href="struct_math_result__struct.html">MathResult</a> * result)
<a name="l00308"></a>00308 {
<a name="l00309"></a>00309     <span class="keywordtype">int</span> k;
<a name="l00310"></a>00310     <span class="keywordtype">double</span> Ag;
<a name="l00311"></a>00311     <span class="keywordtype">double</span> term1, term2;
<a name="l00312"></a>00312 
<a name="l00313"></a>00313     x -= 1.0; <span class="comment">/* Lanczos writes z! instead of Gamma(z) */</span>
<a name="l00314"></a>00314 
<a name="l00315"></a>00315     Ag = lanczos_7_c[0];
<a name="l00316"></a>00316     <span class="keywordflow">for</span>(k=1; k&lt;=8; k++) { Ag += lanczos_7_c[k]/(x+k); }
<a name="l00317"></a>00317 
<a name="l00318"></a>00318     <span class="comment">/* (x+0.5)*log(x+7.5) - (x+7.5) + LogRootTwoPi_ + log(Ag(x)) */</span>
<a name="l00319"></a>00319     term1 = (x+0.5)*log((x+7.5)/M_E);
<a name="l00320"></a>00320     term2 = LogRootTwoPi_ + log(Ag);
<a name="l00321"></a>00321     result-&gt;val  = term1 + (term2 - 7.0);
<a name="l00322"></a>00322     result-&gt;err  = 2.0 * MATH_DBL_EPSILON * (fabs(term1) + fabs(term2) + 7.0);
<a name="l00323"></a>00323     result-&gt;err += MATH_DBL_EPSILON * fabs(result-&gt;val);
<a name="l00324"></a>00324 
<a name="l00325"></a>00325     <span class="keywordflow">return</span> MATH_SUCCESS;
<a name="l00326"></a>00326 }
<a name="l00327"></a>00327 
<a name="l00328"></a>00328 <span class="comment">/* x = eps near zero</span>
<a name="l00329"></a>00329 <span class="comment"> * gives double-precision for |eps| &lt; 0.02</span>
<a name="l00330"></a>00330 <span class="comment"> */</span>
<a name="l00331"></a>00331 <span class="keyword">static</span> <span class="keywordtype">int</span> LnGammaSgn0(<span class="keywordtype">double</span> eps, <a class="code" href="struct_math_result__struct.html">MathResult</a> * lng, <span class="keywordtype">double</span> * sgn)
<a name="l00332"></a>00332 {
<a name="l00333"></a>00333     <span class="comment">/* calculate series for g(eps) = Gamma(eps) eps - 1/(1+eps) - eps/2 */</span>
<a name="l00334"></a>00334     <span class="keyword">const</span> <span class="keywordtype">double</span> c1  = -0.07721566490153286061;
<a name="l00335"></a>00335     <span class="keyword">const</span> <span class="keywordtype">double</span> c2  = -0.01094400467202744461;
<a name="l00336"></a>00336     <span class="keyword">const</span> <span class="keywordtype">double</span> c3  =  0.09252092391911371098;
<a name="l00337"></a>00337     <span class="keyword">const</span> <span class="keywordtype">double</span> c4  = -0.01827191316559981266;
<a name="l00338"></a>00338     <span class="keyword">const</span> <span class="keywordtype">double</span> c5  =  0.01800493109685479790;
<a name="l00339"></a>00339     <span class="keyword">const</span> <span class="keywordtype">double</span> c6  = -0.00685088537872380685;
<a name="l00340"></a>00340     <span class="keyword">const</span> <span class="keywordtype">double</span> c7  =  0.00399823955756846603;
<a name="l00341"></a>00341     <span class="keyword">const</span> <span class="keywordtype">double</span> c8  = -0.00189430621687107802;
<a name="l00342"></a>00342     <span class="keyword">const</span> <span class="keywordtype">double</span> c9  =  0.00097473237804513221;
<a name="l00343"></a>00343     <span class="keyword">const</span> <span class="keywordtype">double</span> c10 = -0.00048434392722255893;
<a name="l00344"></a>00344     <span class="keyword">const</span> <span class="keywordtype">double</span> g6  = c6+eps*(c7+eps*(c8 + eps*(c9 + eps*c10)));
<a name="l00345"></a>00345     <span class="keyword">const</span> <span class="keywordtype">double</span> g   = eps*(c1+eps*(c2+eps*(c3+eps*(c4+eps*(c5+eps*g6)))));
<a name="l00346"></a>00346 
<a name="l00347"></a>00347     <span class="comment">/* calculate Gamma(eps) eps, a positive quantity */</span>
<a name="l00348"></a>00348     <span class="keyword">const</span> <span class="keywordtype">double</span> gee = g + 1.0/(1.0+eps) + 0.5*eps;
<a name="l00349"></a>00349 
<a name="l00350"></a>00350     lng-&gt;val = log(gee/fabs(eps));
<a name="l00351"></a>00351     lng-&gt;err = 4.0 * MATH_DBL_EPSILON * fabs(lng-&gt;val);
<a name="l00352"></a>00352     *sgn = MATH_SIGN(eps);
<a name="l00353"></a>00353 
<a name="l00354"></a>00354     <span class="keywordflow">return</span> MATH_SUCCESS;
<a name="l00355"></a>00355 }
<a name="l00356"></a>00356 
<a name="l00357"></a>00357 
<a name="l00358"></a>00358 <span class="comment">/* x near a negative integer</span>
<a name="l00359"></a>00359 <span class="comment"> * Calculates sign as well as log(|gamma(x)|).</span>
<a name="l00360"></a>00360 <span class="comment"> * x = -N + eps</span>
<a name="l00361"></a>00361 <span class="comment"> * assumes N &gt;= 1</span>
<a name="l00362"></a>00362 <span class="comment"> */</span>
<a name="l00363"></a>00363 <span class="keyword">static</span> <span class="keywordtype">int</span> LnGammaSgnSing(<span class="keywordtype">int</span> N, <span class="keywordtype">double</span> eps, <a class="code" href="struct_math_result__struct.html">MathResult</a> * lng, <span class="keywordtype">double</span> * sgn)
<a name="l00364"></a>00364 {
<a name="l00365"></a>00365     <span class="keywordflow">if</span>(eps == 0.0)
<a name="l00366"></a>00366     {
<a name="l00367"></a>00367         lng-&gt;val = 0.0;
<a name="l00368"></a>00368         lng-&gt;err = 0.0;
<a name="l00369"></a>00369         *sgn = 0.0;
<a name="l00370"></a>00370         MATH_ERROR (<span class="stringliteral">&quot;error&quot;</span>, MATH_EDOM);
<a name="l00371"></a>00371     }
<a name="l00372"></a>00372     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(N == 1)
<a name="l00373"></a>00373     {
<a name="l00374"></a>00374         <span class="comment">/* calculate series for</span>
<a name="l00375"></a>00375 <span class="comment">         * g = eps gamma(-1+eps) + 1 + eps/2 (1+3eps)/(1-eps^2)</span>
<a name="l00376"></a>00376 <span class="comment">         * double-precision for |eps| &lt; 0.02</span>
<a name="l00377"></a>00377 <span class="comment">         */</span>
<a name="l00378"></a>00378         <span class="keyword">const</span> <span class="keywordtype">double</span> c0 =  0.07721566490153286061;
<a name="l00379"></a>00379         <span class="keyword">const</span> <span class="keywordtype">double</span> c1 =  0.08815966957356030521;
<a name="l00380"></a>00380         <span class="keyword">const</span> <span class="keywordtype">double</span> c2 = -0.00436125434555340577;
<a name="l00381"></a>00381         <span class="keyword">const</span> <span class="keywordtype">double</span> c3 =  0.01391065882004640689;
<a name="l00382"></a>00382         <span class="keyword">const</span> <span class="keywordtype">double</span> c4 = -0.00409427227680839100;
<a name="l00383"></a>00383         <span class="keyword">const</span> <span class="keywordtype">double</span> c5 =  0.00275661310191541584;
<a name="l00384"></a>00384         <span class="keyword">const</span> <span class="keywordtype">double</span> c6 = -0.00124162645565305019;
<a name="l00385"></a>00385         <span class="keyword">const</span> <span class="keywordtype">double</span> c7 =  0.00065267976121802783;
<a name="l00386"></a>00386         <span class="keyword">const</span> <span class="keywordtype">double</span> c8 = -0.00032205261682710437;
<a name="l00387"></a>00387         <span class="keyword">const</span> <span class="keywordtype">double</span> c9 =  0.00016229131039545456;
<a name="l00388"></a>00388         <span class="keyword">const</span> <span class="keywordtype">double</span> g5 = c5 + eps*(c6 + eps*(c7 + eps*(c8 + eps*c9)));
<a name="l00389"></a>00389         <span class="keyword">const</span> <span class="keywordtype">double</span> g  = eps*(c0 + eps*(c1 + eps*(c2 + eps*(c3 + eps*(c4 + eps*g5)))));
<a name="l00390"></a>00390 
<a name="l00391"></a>00391         <span class="comment">/* calculate eps gamma(-1+eps), a negative quantity */</span>
<a name="l00392"></a>00392         <span class="keyword">const</span> <span class="keywordtype">double</span> gam_e = g - 1.0 - 0.5*eps*(1.0+3.0*eps)/(1.0 - eps*eps);
<a name="l00393"></a>00393 
<a name="l00394"></a>00394         lng-&gt;val = log(fabs(gam_e)/fabs(eps));
<a name="l00395"></a>00395         lng-&gt;err = 2.0 * MATH_DBL_EPSILON * fabs(lng-&gt;val);
<a name="l00396"></a>00396         *sgn = ( eps &gt; 0.0 ? -1.0 : 1.0 );
<a name="l00397"></a>00397         <span class="keywordflow">return</span> MATH_SUCCESS;
<a name="l00398"></a>00398     }
<a name="l00399"></a>00399     <span class="keywordflow">else</span>
<a name="l00400"></a>00400     {
<a name="l00401"></a>00401         <span class="keywordtype">double</span> g;
<a name="l00402"></a>00402 
<a name="l00403"></a>00403         <span class="comment">/* series for sin(Pi(N+1-eps))/(Pi eps) modulo the sign</span>
<a name="l00404"></a>00404 <span class="comment">         * double-precision for |eps| &lt; 0.02</span>
<a name="l00405"></a>00405 <span class="comment">         */</span>
<a name="l00406"></a>00406         <span class="keyword">const</span> <span class="keywordtype">double</span> cs1 = -1.6449340668482264365;
<a name="l00407"></a>00407         <span class="keyword">const</span> <span class="keywordtype">double</span> cs2 =  0.8117424252833536436;
<a name="l00408"></a>00408         <span class="keyword">const</span> <span class="keywordtype">double</span> cs3 = -0.1907518241220842137;
<a name="l00409"></a>00409         <span class="keyword">const</span> <span class="keywordtype">double</span> cs4 =  0.0261478478176548005;
<a name="l00410"></a>00410         <span class="keyword">const</span> <span class="keywordtype">double</span> cs5 = -0.0023460810354558236;
<a name="l00411"></a>00411         <span class="keyword">const</span> <span class="keywordtype">double</span> e2  = eps*eps;
<a name="l00412"></a>00412         <span class="keyword">const</span> <span class="keywordtype">double</span> sin_ser = 1.0 + e2*(cs1+e2*(cs2+e2*(cs3+e2*(cs4+e2*cs5))));
<a name="l00413"></a>00413 
<a name="l00414"></a>00414         <span class="comment">/* calculate series for ln(gamma(1+N-eps))</span>
<a name="l00415"></a>00415 <span class="comment">         * double-precision for |eps| &lt; 0.02</span>
<a name="l00416"></a>00416 <span class="comment">         */</span>
<a name="l00417"></a>00417         <span class="keywordtype">double</span> aeps = fabs(eps);
<a name="l00418"></a>00418         <span class="keywordtype">double</span> c1, c2, c3, c4, c5, c6, c7;
<a name="l00419"></a>00419         <span class="keywordtype">double</span> lng_ser;
<a name="l00420"></a>00420         <a class="code" href="struct_math_result__struct.html">MathResult</a> c0;
<a name="l00421"></a>00421         <a class="code" href="struct_math_result__struct.html">MathResult</a> psi_0;
<a name="l00422"></a>00422         <a class="code" href="struct_math_result__struct.html">MathResult</a> psi_1;
<a name="l00423"></a>00423         <a class="code" href="struct_math_result__struct.html">MathResult</a> psi_2;
<a name="l00424"></a>00424         <a class="code" href="struct_math_result__struct.html">MathResult</a> psi_3;
<a name="l00425"></a>00425         <a class="code" href="struct_math_result__struct.html">MathResult</a> psi_4;
<a name="l00426"></a>00426         <a class="code" href="struct_math_result__struct.html">MathResult</a> psi_5;
<a name="l00427"></a>00427         <a class="code" href="struct_math_result__struct.html">MathResult</a> psi_6;
<a name="l00428"></a>00428         psi_2.val = 0.0;
<a name="l00429"></a>00429         psi_3.val = 0.0;
<a name="l00430"></a>00430         psi_4.val = 0.0;
<a name="l00431"></a>00431         psi_5.val = 0.0;
<a name="l00432"></a>00432         psi_6.val = 0.0;
<a name="l00433"></a>00433         LnFact(N, &amp;c0);
<a name="l00434"></a>00434         PsiInt(N+1, &amp;psi_0);
<a name="l00435"></a>00435         Psi1Int(N+1, &amp;psi_1);
<a name="l00436"></a>00436         <span class="keywordflow">if</span>(aeps &gt; 0.00001) PsiN(2, N+1.0, &amp;psi_2);
<a name="l00437"></a>00437         <span class="keywordflow">if</span>(aeps &gt; 0.0002)  PsiN(3, N+1.0, &amp;psi_3);
<a name="l00438"></a>00438         <span class="keywordflow">if</span>(aeps &gt; 0.001)   PsiN(4, N+1.0, &amp;psi_4);
<a name="l00439"></a>00439         <span class="keywordflow">if</span>(aeps &gt; 0.005)   PsiN(5, N+1.0, &amp;psi_5);
<a name="l00440"></a>00440         <span class="keywordflow">if</span>(aeps &gt; 0.01)    PsiN(6, N+1.0, &amp;psi_6);
<a name="l00441"></a>00441         c1 = psi_0.val;
<a name="l00442"></a>00442         c2 = psi_1.val/2.0;
<a name="l00443"></a>00443         c3 = psi_2.val/6.0;
<a name="l00444"></a>00444         c4 = psi_3.val/24.0;
<a name="l00445"></a>00445         c5 = psi_4.val/120.0;
<a name="l00446"></a>00446         c6 = psi_5.val/720.0;
<a name="l00447"></a>00447         c7 = psi_6.val/5040.0;
<a name="l00448"></a>00448         lng_ser = c0.val-eps*(c1-eps*(c2-eps*(c3-eps*(c4-eps*(c5-eps*(c6-eps*c7))))));
<a name="l00449"></a>00449 
<a name="l00450"></a>00450         <span class="comment">/* calculate</span>
<a name="l00451"></a>00451 <span class="comment">         * g = ln(|eps gamma(-N+eps)|)</span>
<a name="l00452"></a>00452 <span class="comment">         *   = -ln(gamma(1+N-eps)) + ln(|eps Pi/sin(Pi(N+1+eps))|)</span>
<a name="l00453"></a>00453 <span class="comment">         */</span>
<a name="l00454"></a>00454         g = -lng_ser - log(sin_ser);
<a name="l00455"></a>00455 
<a name="l00456"></a>00456         lng-&gt;val = g - log(fabs(eps));
<a name="l00457"></a>00457         lng-&gt;err = c0.err + 2.0 * MATH_DBL_EPSILON * (fabs(g) + fabs(lng-&gt;val));
<a name="l00458"></a>00458 
<a name="l00459"></a>00459         *sgn = ( MATH_IS_ODD(N) ? -1.0 : 1.0 ) * ( eps &gt; 0.0 ? 1.0 : -1.0 );
<a name="l00460"></a>00460 
<a name="l00461"></a>00461         <span class="keywordflow">return</span> MATH_SUCCESS;
<a name="l00462"></a>00462     }
<a name="l00463"></a>00463 }
<a name="l00464"></a>00464 
<a name="l00465"></a>00465 <span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">int</span> LnGamma1Pade(<span class="keyword">const</span> <span class="keywordtype">double</span> eps, <a class="code" href="struct_math_result__struct.html">MathResult</a> * result)
<a name="l00466"></a>00466 {
<a name="l00467"></a>00467     <span class="comment">/* Use (2,2) Pade for Log[Gamma[1+eps]]/eps</span>
<a name="l00468"></a>00468 <span class="comment">    * plus a correction series.</span>
<a name="l00469"></a>00469 <span class="comment">    */</span>
<a name="l00470"></a>00470     <span class="keyword">const</span> <span class="keywordtype">double</span> n1 = -1.0017419282349508699871138440;
<a name="l00471"></a>00471     <span class="keyword">const</span> <span class="keywordtype">double</span> n2 =  1.7364839209922879823280541733;
<a name="l00472"></a>00472     <span class="keyword">const</span> <span class="keywordtype">double</span> d1 =  1.2433006018858751556055436011;
<a name="l00473"></a>00473     <span class="keyword">const</span> <span class="keywordtype">double</span> d2 =  5.0456274100274010152489597514;
<a name="l00474"></a>00474     <span class="keyword">const</span> <span class="keywordtype">double</span> num = (eps + n1) * (eps + n2);
<a name="l00475"></a>00475     <span class="keyword">const</span> <span class="keywordtype">double</span> den = (eps + d1) * (eps + d2);
<a name="l00476"></a>00476     <span class="keyword">const</span> <span class="keywordtype">double</span> pade = 2.0816265188662692474880210318 * num / den;
<a name="l00477"></a>00477     <span class="keyword">const</span> <span class="keywordtype">double</span> c0 =  0.004785324257581753;
<a name="l00478"></a>00478     <span class="keyword">const</span> <span class="keywordtype">double</span> c1 = -0.01192457083645441;
<a name="l00479"></a>00479     <span class="keyword">const</span> <span class="keywordtype">double</span> c2 =  0.01931961413960498;
<a name="l00480"></a>00480     <span class="keyword">const</span> <span class="keywordtype">double</span> c3 = -0.02594027398725020;
<a name="l00481"></a>00481     <span class="keyword">const</span> <span class="keywordtype">double</span> c4 =  0.03141928755021455;
<a name="l00482"></a>00482     <span class="keyword">const</span> <span class="keywordtype">double</span> eps5 = eps*eps*eps*eps*eps;
<a name="l00483"></a>00483     <span class="keyword">const</span> <span class="keywordtype">double</span> corr = eps5 * (c0 + eps*(c1 + eps*(c2 + eps*(c3 + c4*eps))));
<a name="l00484"></a>00484     result-&gt;val = eps * (pade + corr);
<a name="l00485"></a>00485     result-&gt;err = 2.0 * MATH_DBL_EPSILON * fabs(result-&gt;val);
<a name="l00486"></a>00486     <span class="keywordflow">return</span> MATH_SUCCESS;
<a name="l00487"></a>00487 }
<a name="l00488"></a>00488 
<a name="l00489"></a>00489 <span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">int</span> LnGamma2Pade(<span class="keyword">const</span> <span class="keywordtype">double</span> eps, <a class="code" href="struct_math_result__struct.html">MathResult</a> * result)
<a name="l00490"></a>00490 {
<a name="l00491"></a>00491     <span class="comment">/* Use (2,2) Pade for Log[Gamma[2+eps]]/eps</span>
<a name="l00492"></a>00492 <span class="comment">    * plus a correction series.</span>
<a name="l00493"></a>00493 <span class="comment">    */</span>
<a name="l00494"></a>00494     <span class="keyword">const</span> <span class="keywordtype">double</span> n1 = 1.000895834786669227164446568;
<a name="l00495"></a>00495     <span class="keyword">const</span> <span class="keywordtype">double</span> n2 = 4.209376735287755081642901277;
<a name="l00496"></a>00496     <span class="keyword">const</span> <span class="keywordtype">double</span> d1 = 2.618851904903217274682578255;
<a name="l00497"></a>00497     <span class="keyword">const</span> <span class="keywordtype">double</span> d2 = 10.85766559900983515322922936;
<a name="l00498"></a>00498     <span class="keyword">const</span> <span class="keywordtype">double</span> num = (eps + n1) * (eps + n2);
<a name="l00499"></a>00499     <span class="keyword">const</span> <span class="keywordtype">double</span> den = (eps + d1) * (eps + d2);
<a name="l00500"></a>00500     <span class="keyword">const</span> <span class="keywordtype">double</span> pade = 2.85337998765781918463568869 * num/den;
<a name="l00501"></a>00501     <span class="keyword">const</span> <span class="keywordtype">double</span> c0 =  0.0001139406357036744;
<a name="l00502"></a>00502     <span class="keyword">const</span> <span class="keywordtype">double</span> c1 = -0.0001365435269792533;
<a name="l00503"></a>00503     <span class="keyword">const</span> <span class="keywordtype">double</span> c2 =  0.0001067287169183665;
<a name="l00504"></a>00504     <span class="keyword">const</span> <span class="keywordtype">double</span> c3 = -0.0000693271800931282;
<a name="l00505"></a>00505     <span class="keyword">const</span> <span class="keywordtype">double</span> c4 =  0.0000407220927867950;
<a name="l00506"></a>00506     <span class="keyword">const</span> <span class="keywordtype">double</span> eps5 = eps*eps*eps*eps*eps;
<a name="l00507"></a>00507     <span class="keyword">const</span> <span class="keywordtype">double</span> corr = eps5 * (c0 + eps*(c1 + eps*(c2 + eps*(c3 + c4*eps))));
<a name="l00508"></a>00508     result-&gt;val = eps * (pade + corr);
<a name="l00509"></a>00509     result-&gt;err = 2.0 * MATH_DBL_EPSILON * fabs(result-&gt;val);
<a name="l00510"></a>00510     <span class="keywordflow">return</span> MATH_SUCCESS;
<a name="l00511"></a>00511 }
<a name="l00512"></a>00512 
<a name="l00513"></a>00513 
<a name="l00514"></a>00514 <span class="comment">/* series for gammastar(x)</span>
<a name="l00515"></a>00515 <span class="comment"> * double-precision for x &gt; 10.0</span>
<a name="l00516"></a>00516 <span class="comment"> */</span>
<a name="l00517"></a>00517 <span class="keyword">static</span> <span class="keywordtype">int</span> GammaStarSeries(<span class="keyword">const</span> <span class="keywordtype">double</span> x, <a class="code" href="struct_math_result__struct.html">MathResult</a> * result)
<a name="l00518"></a>00518 {
<a name="l00519"></a>00519     <span class="comment">/* Use the Stirling series for the correction to Log(Gamma(x)),</span>
<a name="l00520"></a>00520 <span class="comment">    * which is better behaved and easier to compute than the</span>
<a name="l00521"></a>00521 <span class="comment">    * regular Stirling series for Gamma(x). </span>
<a name="l00522"></a>00522 <span class="comment">    */</span>
<a name="l00523"></a>00523     <span class="keyword">const</span> <span class="keywordtype">double</span> y = 1.0/(x*x);
<a name="l00524"></a>00524     <span class="keyword">const</span> <span class="keywordtype">double</span> c0 =  1.0/12.0;
<a name="l00525"></a>00525     <span class="keyword">const</span> <span class="keywordtype">double</span> c1 = -1.0/360.0;
<a name="l00526"></a>00526     <span class="keyword">const</span> <span class="keywordtype">double</span> c2 =  1.0/1260.0;
<a name="l00527"></a>00527     <span class="keyword">const</span> <span class="keywordtype">double</span> c3 = -1.0/1680.0;
<a name="l00528"></a>00528     <span class="keyword">const</span> <span class="keywordtype">double</span> c4 =  1.0/1188.0;
<a name="l00529"></a>00529     <span class="keyword">const</span> <span class="keywordtype">double</span> c5 = -691.0/360360.0;
<a name="l00530"></a>00530     <span class="keyword">const</span> <span class="keywordtype">double</span> c6 =  1.0/156.0;
<a name="l00531"></a>00531     <span class="keyword">const</span> <span class="keywordtype">double</span> c7 = -3617.0/122400.0;
<a name="l00532"></a>00532     <span class="keyword">const</span> <span class="keywordtype">double</span> ser = c0 + y*(c1 + y*(c2 + y*(c3 + y*(c4 + y*(c5 + y*(c6 + y*c7))))));
<a name="l00533"></a>00533     result-&gt;val = exp(ser/x);
<a name="l00534"></a>00534     result-&gt;err = 2.0 * MATH_DBL_EPSILON * result-&gt;val * MATH_MAX_DBL(1.0, ser/x);
<a name="l00535"></a>00535     <span class="keywordflow">return</span> MATH_SUCCESS;
<a name="l00536"></a>00536 }
<a name="l00537"></a>00537 
<a name="l00538"></a>00538 
<a name="l00539"></a>00539 <span class="comment">/* Chebyshev expansion for log(gamma(x)/gamma(8))</span>
<a name="l00540"></a>00540 <span class="comment"> * 5 &lt; x &lt; 10</span>
<a name="l00541"></a>00541 <span class="comment"> * -1 &lt; t &lt; 1</span>
<a name="l00542"></a>00542 <span class="comment"> */</span>
<a name="l00543"></a>00543 <span class="keyword">static</span> <span class="keywordtype">double</span> gamma_5_10_data[24] = {
<a name="l00544"></a>00544  -1.5285594096661578881275075214,
<a name="l00545"></a>00545   4.8259152300595906319768555035,
<a name="l00546"></a>00546   0.2277712320977614992970601978,
<a name="l00547"></a>00547  -0.0138867665685617873604917300,
<a name="l00548"></a>00548   0.0012704876495201082588139723,
<a name="l00549"></a>00549  -0.0001393841240254993658962470,
<a name="l00550"></a>00550   0.0000169709242992322702260663,
<a name="l00551"></a>00551  -2.2108528820210580075775889168e-06,
<a name="l00552"></a>00552   3.0196602854202309805163918716e-07,
<a name="l00553"></a>00553  -4.2705675000079118380587357358e-08,
<a name="l00554"></a>00554   6.2026423818051402794663551945e-09,
<a name="l00555"></a>00555  -9.1993973208880910416311405656e-10,
<a name="l00556"></a>00556   1.3875551258028145778301211638e-10,
<a name="l00557"></a>00557  -2.1218861491906788718519522978e-11,
<a name="l00558"></a>00558   3.2821736040381439555133562600e-12,
<a name="l00559"></a>00559  -5.1260001009953791220611135264e-13,
<a name="l00560"></a>00560   8.0713532554874636696982146610e-14,
<a name="l00561"></a>00561  -1.2798522376569209083811628061e-14,
<a name="l00562"></a>00562   2.0417711600852502310258808643e-15,
<a name="l00563"></a>00563  -3.2745239502992355776882614137e-16,
<a name="l00564"></a>00564   5.2759418422036579482120897453e-17,
<a name="l00565"></a>00565  -8.5354147151695233960425725513e-18,
<a name="l00566"></a>00566   1.3858639703888078291599886143e-18,
<a name="l00567"></a>00567  -2.2574398807738626571560124396e-19
<a name="l00568"></a>00568 };
<a name="l00569"></a>00569 
<a name="l00570"></a>00570 <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="struct_cheb_series_struct.html">ChebSeries</a> gamma_5_10_cs = {
<a name="l00571"></a>00571     gamma_5_10_data,
<a name="l00572"></a>00572     23,
<a name="l00573"></a>00573     -1, 1,
<a name="l00574"></a>00574     11
<a name="l00575"></a>00575 };
<a name="l00576"></a>00576 
<a name="l00577"></a>00577 
<a name="l00578"></a>00578 <span class="comment">/* gamma(x) for x &gt;= 1/2</span>
<a name="l00579"></a>00579 <span class="comment"> * assumes x &gt;= 1/2</span>
<a name="l00580"></a>00580 <span class="comment"> */</span>
<a name="l00581"></a>00581 <span class="keyword">static</span> <span class="keywordtype">int</span> GammaXgtHalf(<span class="keyword">const</span> <span class="keywordtype">double</span> x, <a class="code" href="struct_math_result__struct.html">MathResult</a> * result)
<a name="l00582"></a>00582 {
<a name="l00583"></a>00583     <span class="comment">/* CHECK_POINTER(result) */</span>
<a name="l00584"></a>00584 
<a name="l00585"></a>00585     <span class="keywordflow">if</span>(x == 0.5)
<a name="l00586"></a>00586     {
<a name="l00587"></a>00587         result-&gt;val = 1.77245385090551602729817;
<a name="l00588"></a>00588         result-&gt;err = MATH_DBL_EPSILON * result-&gt;val;
<a name="l00589"></a>00589         <span class="keywordflow">return</span> MATH_SUCCESS;
<a name="l00590"></a>00590     }
<a name="l00591"></a>00591     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (x &lt;= (MATH_SF_FACT_NMAX + 1.0) &amp;&amp; x == floor(x))
<a name="l00592"></a>00592     {
<a name="l00593"></a>00593         <span class="keywordtype">int</span> n = (int) floor (x);
<a name="l00594"></a>00594         result-&gt;val = fact_table[n - 1].f;
<a name="l00595"></a>00595         result-&gt;err = MATH_DBL_EPSILON * result-&gt;val;
<a name="l00596"></a>00596         <span class="keywordflow">return</span> MATH_SUCCESS;
<a name="l00597"></a>00597     }    
<a name="l00598"></a>00598     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(fabs(x - 1.0) &lt; 0.01)
<a name="l00599"></a>00599     {
<a name="l00600"></a>00600         <span class="comment">/* Use series for Gamma[1+eps] - 1/(1+eps).</span>
<a name="l00601"></a>00601 <span class="comment">         */</span>
<a name="l00602"></a>00602         <span class="keyword">const</span> <span class="keywordtype">double</span> eps = x - 1.0;
<a name="l00603"></a>00603         <span class="keyword">const</span> <span class="keywordtype">double</span> c1 =  0.4227843350984671394;
<a name="l00604"></a>00604         <span class="keyword">const</span> <span class="keywordtype">double</span> c2 = -0.01094400467202744461;
<a name="l00605"></a>00605         <span class="keyword">const</span> <span class="keywordtype">double</span> c3 =  0.09252092391911371098;
<a name="l00606"></a>00606         <span class="keyword">const</span> <span class="keywordtype">double</span> c4 = -0.018271913165599812664;
<a name="l00607"></a>00607         <span class="keyword">const</span> <span class="keywordtype">double</span> c5 =  0.018004931096854797895;
<a name="l00608"></a>00608         <span class="keyword">const</span> <span class="keywordtype">double</span> c6 = -0.006850885378723806846;
<a name="l00609"></a>00609         <span class="keyword">const</span> <span class="keywordtype">double</span> c7 =  0.003998239557568466030;
<a name="l00610"></a>00610         result-&gt;val = 1.0/x + eps*(c1+eps*(c2+eps*(c3+eps*(c4+eps*(c5+eps*(c6+eps*c7))))));
<a name="l00611"></a>00611         result-&gt;err = MATH_DBL_EPSILON;
<a name="l00612"></a>00612         <span class="keywordflow">return</span> MATH_SUCCESS;
<a name="l00613"></a>00613     }
<a name="l00614"></a>00614     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(fabs(x - 2.0) &lt; 0.01)
<a name="l00615"></a>00615     {
<a name="l00616"></a>00616         <span class="comment">/* Use series for Gamma[1 + eps].</span>
<a name="l00617"></a>00617 <span class="comment">         */</span>
<a name="l00618"></a>00618         <span class="keyword">const</span> <span class="keywordtype">double</span> eps = x - 2.0;
<a name="l00619"></a>00619         <span class="keyword">const</span> <span class="keywordtype">double</span> c1 =  0.4227843350984671394;
<a name="l00620"></a>00620         <span class="keyword">const</span> <span class="keywordtype">double</span> c2 =  0.4118403304264396948;
<a name="l00621"></a>00621         <span class="keyword">const</span> <span class="keywordtype">double</span> c3 =  0.08157691924708626638;
<a name="l00622"></a>00622         <span class="keyword">const</span> <span class="keywordtype">double</span> c4 =  0.07424901075351389832;
<a name="l00623"></a>00623         <span class="keyword">const</span> <span class="keywordtype">double</span> c5 = -0.00026698206874501476832;
<a name="l00624"></a>00624         <span class="keyword">const</span> <span class="keywordtype">double</span> c6 =  0.011154045718130991049;
<a name="l00625"></a>00625         <span class="keyword">const</span> <span class="keywordtype">double</span> c7 = -0.002852645821155340816;
<a name="l00626"></a>00626         <span class="keyword">const</span> <span class="keywordtype">double</span> c8 =  0.0021039333406973880085;
<a name="l00627"></a>00627         result-&gt;val = 1.0 + eps*(c1+eps*(c2+eps*(c3+eps*(c4+eps*(c5+eps*(c6+eps*(c7+eps*c8)))))));
<a name="l00628"></a>00628         result-&gt;err = MATH_DBL_EPSILON;
<a name="l00629"></a>00629         <span class="keywordflow">return</span> MATH_SUCCESS;
<a name="l00630"></a>00630     }
<a name="l00631"></a>00631     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(x &lt; 5.0)
<a name="l00632"></a>00632     {
<a name="l00633"></a>00633         <span class="comment">/* Exponentiating the logarithm is fine, as</span>
<a name="l00634"></a>00634 <span class="comment">         * long as the exponential is not so large</span>
<a name="l00635"></a>00635 <span class="comment">         * that it greatly amplifies the error.</span>
<a name="l00636"></a>00636 <span class="comment">         */</span>
<a name="l00637"></a>00637         <a class="code" href="struct_math_result__struct.html">MathResult</a> lg;
<a name="l00638"></a>00638         LnGammaLanczos(x, &amp;lg);
<a name="l00639"></a>00639         result-&gt;val = exp(lg.val);
<a name="l00640"></a>00640         result-&gt;err = result-&gt;val * (lg.err + 2.0 * MATH_DBL_EPSILON);
<a name="l00641"></a>00641         <span class="keywordflow">return</span> MATH_SUCCESS;
<a name="l00642"></a>00642     }
<a name="l00643"></a>00643     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(x &lt; 10.0)
<a name="l00644"></a>00644     {
<a name="l00645"></a>00645         <span class="comment">/* This is a sticky area. The logarithm</span>
<a name="l00646"></a>00646 <span class="comment">         * is too large and the gammastar series</span>
<a name="l00647"></a>00647 <span class="comment">         * is not good.</span>
<a name="l00648"></a>00648 <span class="comment">         */</span>
<a name="l00649"></a>00649         <span class="keyword">const</span> <span class="keywordtype">double</span> gamma_8 = 5040.0;
<a name="l00650"></a>00650         <span class="keyword">const</span> <span class="keywordtype">double</span> t = (2.0*x - 15.0)/5.0;
<a name="l00651"></a>00651         <a class="code" href="struct_math_result__struct.html">MathResult</a> c;
<a name="l00652"></a>00652         ChebEval(&amp;gamma_5_10_cs, t, &amp;c);
<a name="l00653"></a>00653         result-&gt;val  = exp(c.val) * gamma_8;
<a name="l00654"></a>00654         result-&gt;err  = result-&gt;val * c.err;
<a name="l00655"></a>00655         result-&gt;err += 2.0 * MATH_DBL_EPSILON * result-&gt;val;
<a name="l00656"></a>00656         <span class="keywordflow">return</span> MATH_SUCCESS;
<a name="l00657"></a>00657     }
<a name="l00658"></a>00658     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(x &lt; MATH_SF_GAMMA_XMAX)
<a name="l00659"></a>00659     {
<a name="l00660"></a>00660         <span class="comment">/* We do not want to exponentiate the logarithm</span>
<a name="l00661"></a>00661 <span class="comment">         * if x is large because of the inevitable</span>
<a name="l00662"></a>00662 <span class="comment">         * inflation of the error. So we carefully</span>
<a name="l00663"></a>00663 <span class="comment">         * use pow() and exp() with exact quantities.</span>
<a name="l00664"></a>00664 <span class="comment">         */</span>
<a name="l00665"></a>00665         <span class="keywordtype">double</span> p = pow(x, 0.5*x);
<a name="l00666"></a>00666         <span class="keywordtype">double</span> e = exp(-x);
<a name="l00667"></a>00667         <span class="keywordtype">double</span> q = (p * e) * p;
<a name="l00668"></a>00668         <span class="keywordtype">double</span> pre = M_SQRT2 * M_SQRTPI * q/sqrt(x);
<a name="l00669"></a>00669         <a class="code" href="struct_math_result__struct.html">MathResult</a> gstar;
<a name="l00670"></a>00670         <span class="keywordtype">int</span> stat_gs = GammaStarSeries(x, &amp;gstar);
<a name="l00671"></a>00671         result-&gt;val = pre * gstar.val;
<a name="l00672"></a>00672         result-&gt;err = (x + 2.5) * MATH_DBL_EPSILON * result-&gt;val;
<a name="l00673"></a>00673         <span class="keywordflow">return</span> stat_gs;
<a name="l00674"></a>00674     }
<a name="l00675"></a>00675     <span class="keywordflow">else</span>
<a name="l00676"></a>00676     {
<a name="l00677"></a>00677         OVERFLOW_ERROR(result);
<a name="l00678"></a>00678     }
<a name="l00679"></a>00679 }
<a name="l00680"></a>00680 
<a name="l00681"></a>00681 <span class="keywordtype">int</span> LnGammaE(<span class="keywordtype">double</span> x, <a class="code" href="struct_math_result__struct.html">MathResult</a> * result)
<a name="l00682"></a>00682 {
<a name="l00683"></a>00683     <span class="comment">/* CHECK_POINTER(result) */</span>
<a name="l00684"></a>00684 
<a name="l00685"></a>00685     <span class="keywordflow">if</span>(fabs(x - 1.0) &lt; 0.01)
<a name="l00686"></a>00686     {
<a name="l00687"></a>00687         <span class="comment">/* Note that we must amplify the errors</span>
<a name="l00688"></a>00688 <span class="comment">         * from the Pade evaluations because of</span>
<a name="l00689"></a>00689 <span class="comment">         * the way we must pass the argument, i.e.</span>
<a name="l00690"></a>00690 <span class="comment">         * writing (1-x) is a loss of precision</span>
<a name="l00691"></a>00691 <span class="comment">         * when x is near 1.</span>
<a name="l00692"></a>00692 <span class="comment">         */</span>
<a name="l00693"></a>00693         <span class="keywordtype">int</span> stat = LnGamma1Pade(x - 1.0, result);
<a name="l00694"></a>00694         result-&gt;err *= 1.0/(MATH_DBL_EPSILON + fabs(x - 1.0));
<a name="l00695"></a>00695         <span class="keywordflow">return</span> stat;
<a name="l00696"></a>00696     }
<a name="l00697"></a>00697     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(fabs(x - 2.0) &lt; 0.01)
<a name="l00698"></a>00698     {
<a name="l00699"></a>00699         <span class="keywordtype">int</span> stat = LnGamma2Pade(x - 2.0, result);
<a name="l00700"></a>00700         result-&gt;err *= 1.0/(MATH_DBL_EPSILON + fabs(x - 2.0));
<a name="l00701"></a>00701         <span class="keywordflow">return</span> stat;
<a name="l00702"></a>00702     }
<a name="l00703"></a>00703     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(x &gt;= 0.5)
<a name="l00704"></a>00704     {
<a name="l00705"></a>00705         <span class="keywordflow">return</span> LnGammaLanczos(x, result);
<a name="l00706"></a>00706     }
<a name="l00707"></a>00707     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(x == 0.0)
<a name="l00708"></a>00708     {
<a name="l00709"></a>00709         DOMAIN_ERROR(result);
<a name="l00710"></a>00710     }
<a name="l00711"></a>00711     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(fabs(x) &lt; 0.02)
<a name="l00712"></a>00712     {
<a name="l00713"></a>00713         <span class="keywordtype">double</span> sgn;
<a name="l00714"></a>00714         <span class="keywordflow">return</span> LnGammaSgn0(x, result, &amp;sgn);
<a name="l00715"></a>00715     }
<a name="l00716"></a>00716     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(x &gt; -0.5/(MATH_DBL_EPSILON*M_PI))
<a name="l00717"></a>00717     {
<a name="l00718"></a>00718         <span class="comment">/* Try to extract a fractional</span>
<a name="l00719"></a>00719 <span class="comment">         * part from x.</span>
<a name="l00720"></a>00720 <span class="comment">         */</span>
<a name="l00721"></a>00721         <span class="keywordtype">double</span> z  = 1.0 - x;
<a name="l00722"></a>00722         <span class="keywordtype">double</span> s  = sin(M_PI*z);
<a name="l00723"></a>00723         <span class="keywordtype">double</span> as = fabs(s);
<a name="l00724"></a>00724         <span class="keywordflow">if</span>(s == 0.0)
<a name="l00725"></a>00725         {
<a name="l00726"></a>00726             DOMAIN_ERROR(result);
<a name="l00727"></a>00727         }
<a name="l00728"></a>00728         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(as &lt; M_PI*0.015)
<a name="l00729"></a>00729         {
<a name="l00730"></a>00730             <span class="comment">/* x is near a negative integer, -N */</span>
<a name="l00731"></a>00731             <span class="keywordflow">if</span>(x &lt; INT_MIN + 2.0)
<a name="l00732"></a>00732             {
<a name="l00733"></a>00733                 result-&gt;val = 0.0;
<a name="l00734"></a>00734                 result-&gt;err = 0.0;
<a name="l00735"></a>00735                 MATH_ERROR (<span class="stringliteral">&quot;error&quot;</span>, MATH_EROUND);
<a name="l00736"></a>00736             }
<a name="l00737"></a>00737             <span class="keywordflow">else</span>
<a name="l00738"></a>00738             {
<a name="l00739"></a>00739                 <span class="keywordtype">int</span> N = -(int)(x - 0.5);
<a name="l00740"></a>00740                 <span class="keywordtype">double</span> eps = x + N;
<a name="l00741"></a>00741                 <span class="keywordtype">double</span> sgn;
<a name="l00742"></a>00742                 <span class="keywordflow">return</span> LnGammaSgnSing(N, eps, result, &amp;sgn);
<a name="l00743"></a>00743             }
<a name="l00744"></a>00744         }
<a name="l00745"></a>00745         <span class="keywordflow">else</span>
<a name="l00746"></a>00746         {
<a name="l00747"></a>00747             <a class="code" href="struct_math_result__struct.html">MathResult</a> lg_z;
<a name="l00748"></a>00748             LnGammaLanczos(z, &amp;lg_z);
<a name="l00749"></a>00749             result-&gt;val = M_LNPI - (log(as) + lg_z.val);
<a name="l00750"></a>00750             result-&gt;err = 2.0 * MATH_DBL_EPSILON * fabs(result-&gt;val) + lg_z.err;
<a name="l00751"></a>00751             <span class="keywordflow">return</span> MATH_SUCCESS;
<a name="l00752"></a>00752         }
<a name="l00753"></a>00753     }
<a name="l00754"></a>00754     <span class="keywordflow">else</span>
<a name="l00755"></a>00755     {
<a name="l00756"></a>00756         <span class="comment">/* |x| was too large to extract any fractional part */</span>
<a name="l00757"></a>00757         result-&gt;val = 0.0;
<a name="l00758"></a>00758         result-&gt;err = 0.0;
<a name="l00759"></a>00759         MATH_ERROR (<span class="stringliteral">&quot;error&quot;</span>, MATH_EROUND);
<a name="l00760"></a>00760     }
<a name="l00761"></a>00761 }
<a name="l00762"></a>00762 
<a name="l00763"></a>00763 
<a name="l00764"></a>00764 <span class="keywordtype">int</span> LnGammaSgnE(<span class="keywordtype">double</span> x, <a class="code" href="struct_math_result__struct.html">MathResult</a> * result_lg, <span class="keywordtype">double</span> * sgn)
<a name="l00765"></a>00765 {
<a name="l00766"></a>00766     <span class="keywordflow">if</span>(fabs(x - 1.0) &lt; 0.01)
<a name="l00767"></a>00767     {
<a name="l00768"></a>00768         <span class="keywordtype">int</span> stat = LnGamma1Pade(x - 1.0, result_lg);
<a name="l00769"></a>00769         result_lg-&gt;err *= 1.0/(MATH_DBL_EPSILON + fabs(x - 1.0));
<a name="l00770"></a>00770         *sgn = 1.0;
<a name="l00771"></a>00771         <span class="keywordflow">return</span> stat;
<a name="l00772"></a>00772     }
<a name="l00773"></a>00773     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(fabs(x - 2.0) &lt; 0.01)
<a name="l00774"></a>00774     {
<a name="l00775"></a>00775         <span class="keywordtype">int</span> stat = LnGamma2Pade(x - 2.0, result_lg);
<a name="l00776"></a>00776         result_lg-&gt;err *= 1.0/(MATH_DBL_EPSILON + fabs(x - 2.0));
<a name="l00777"></a>00777         *sgn = 1.0;
<a name="l00778"></a>00778         <span class="keywordflow">return</span> stat;
<a name="l00779"></a>00779     }
<a name="l00780"></a>00780     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(x &gt;= 0.5)
<a name="l00781"></a>00781     {
<a name="l00782"></a>00782         *sgn = 1.0;
<a name="l00783"></a>00783         <span class="keywordflow">return</span> LnGammaLanczos(x, result_lg);
<a name="l00784"></a>00784     }
<a name="l00785"></a>00785     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(x == 0.0)
<a name="l00786"></a>00786     {
<a name="l00787"></a>00787         *sgn = 0.0;
<a name="l00788"></a>00788         DOMAIN_ERROR(result_lg);
<a name="l00789"></a>00789     }
<a name="l00790"></a>00790     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(fabs(x) &lt; 0.02)
<a name="l00791"></a>00791     {
<a name="l00792"></a>00792         <span class="keywordflow">return</span> LnGammaSgn0(x, result_lg, sgn);
<a name="l00793"></a>00793     }
<a name="l00794"></a>00794     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(x &gt; -0.5/(MATH_DBL_EPSILON*M_PI))
<a name="l00795"></a>00795     {
<a name="l00796"></a>00796         <span class="comment">/* Try to extract a fractional</span>
<a name="l00797"></a>00797 <span class="comment">         * part from x.</span>
<a name="l00798"></a>00798 <span class="comment">         */</span>
<a name="l00799"></a>00799         <span class="keywordtype">double</span> z = 1.0 - x;
<a name="l00800"></a>00800         <span class="keywordtype">double</span> s = sin(M_PI*x);
<a name="l00801"></a>00801         <span class="keywordtype">double</span> as = fabs(s);
<a name="l00802"></a>00802         <span class="keywordflow">if</span>(s == 0.0)
<a name="l00803"></a>00803         {
<a name="l00804"></a>00804             *sgn = 0.0;
<a name="l00805"></a>00805             DOMAIN_ERROR(result_lg);
<a name="l00806"></a>00806         }
<a name="l00807"></a>00807         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(as &lt; M_PI*0.015)
<a name="l00808"></a>00808         {
<a name="l00809"></a>00809             <span class="comment">/* x is near a negative integer, -N */</span>
<a name="l00810"></a>00810             <span class="keywordflow">if</span>(x &lt; INT_MIN + 2.0)
<a name="l00811"></a>00811             {
<a name="l00812"></a>00812                 result_lg-&gt;val = 0.0;
<a name="l00813"></a>00813                 result_lg-&gt;err = 0.0;
<a name="l00814"></a>00814                 *sgn = 0.0;
<a name="l00815"></a>00815                 MATH_ERROR (<span class="stringliteral">&quot;error&quot;</span>, MATH_EROUND);
<a name="l00816"></a>00816             }
<a name="l00817"></a>00817             <span class="keywordflow">else</span>
<a name="l00818"></a>00818             {
<a name="l00819"></a>00819                 <span class="keywordtype">int</span> N = -(int)(x - 0.5);
<a name="l00820"></a>00820                 <span class="keywordtype">double</span> eps = x + N;
<a name="l00821"></a>00821                 <span class="keywordflow">return</span> LnGammaSgnSing(N, eps, result_lg, sgn);
<a name="l00822"></a>00822             }
<a name="l00823"></a>00823         }
<a name="l00824"></a>00824         <span class="keywordflow">else</span>
<a name="l00825"></a>00825         {
<a name="l00826"></a>00826             <a class="code" href="struct_math_result__struct.html">MathResult</a> lg_z;
<a name="l00827"></a>00827             LnGammaLanczos(z, &amp;lg_z);
<a name="l00828"></a>00828             *sgn = (s &gt; 0.0 ? 1.0 : -1.0);
<a name="l00829"></a>00829             result_lg-&gt;val = M_LNPI - (log(as) + lg_z.val);
<a name="l00830"></a>00830             result_lg-&gt;err = 2.0 * MATH_DBL_EPSILON * fabs(result_lg-&gt;val) + lg_z.err;
<a name="l00831"></a>00831             <span class="keywordflow">return</span> MATH_SUCCESS;
<a name="l00832"></a>00832         }
<a name="l00833"></a>00833     }
<a name="l00834"></a>00834     <span class="keywordflow">else</span>
<a name="l00835"></a>00835     {
<a name="l00836"></a>00836         <span class="comment">/* |x| was too large to extract any fractional part */</span>
<a name="l00837"></a>00837         result_lg-&gt;val = 0.0;
<a name="l00838"></a>00838         result_lg-&gt;err = 0.0;
<a name="l00839"></a>00839         *sgn = 0.0;
<a name="l00840"></a>00840         MATH_ERROR (<span class="stringliteral">&quot;x too large to extract fraction part&quot;</span>, MATH_EROUND);
<a name="l00841"></a>00841     }
<a name="l00842"></a>00842 }
<a name="l00843"></a>00843 
<a name="l00844"></a>00844 
<a name="l00845"></a>00845 <span class="keywordtype">int</span> GammaE(<span class="keyword">const</span> <span class="keywordtype">double</span> x, <a class="code" href="struct_math_result__struct.html">MathResult</a> * result)
<a name="l00846"></a>00846 {
<a name="l00847"></a>00847     <span class="keywordflow">if</span>(x &lt; 0.5)
<a name="l00848"></a>00848     {
<a name="l00849"></a>00849         <span class="keywordtype">int</span> rint_x = (int)floor(x+0.5);
<a name="l00850"></a>00850         <span class="keywordtype">double</span> f_x = x - rint_x;
<a name="l00851"></a>00851         <span class="keywordtype">double</span> sgn_gamma = ( MATH_IS_EVEN(rint_x) ? 1.0 : -1.0 );
<a name="l00852"></a>00852         <span class="keywordtype">double</span> sin_term = sgn_gamma * sin(M_PI * f_x) / M_PI;
<a name="l00853"></a>00853 
<a name="l00854"></a>00854         <span class="keywordflow">if</span>(sin_term == 0.0)
<a name="l00855"></a>00855         {
<a name="l00856"></a>00856             DOMAIN_ERROR(result);
<a name="l00857"></a>00857         }
<a name="l00858"></a>00858         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(x &gt; -169.0)
<a name="l00859"></a>00859         {
<a name="l00860"></a>00860             <a class="code" href="struct_math_result__struct.html">MathResult</a> g;
<a name="l00861"></a>00861             GammaXgtHalf(1.0-x, &amp;g);
<a name="l00862"></a>00862             <span class="keywordflow">if</span>(fabs(sin_term) * g.val * MATH_DBL_MIN &lt; 1.0)
<a name="l00863"></a>00863             {
<a name="l00864"></a>00864                 result-&gt;val  = 1.0/(sin_term * g.val);
<a name="l00865"></a>00865                 result-&gt;err  = fabs(g.err/g.val) * fabs(result-&gt;val);
<a name="l00866"></a>00866                 result-&gt;err += 2.0 * MATH_DBL_EPSILON * fabs(result-&gt;val);
<a name="l00867"></a>00867                 <span class="keywordflow">return</span> MATH_SUCCESS;
<a name="l00868"></a>00868             }
<a name="l00869"></a>00869             <span class="keywordflow">else</span>
<a name="l00870"></a>00870             {
<a name="l00871"></a>00871                 UNDERFLOW_ERROR(result);
<a name="l00872"></a>00872             }
<a name="l00873"></a>00873         }
<a name="l00874"></a>00874         <span class="keywordflow">else</span>
<a name="l00875"></a>00875         {
<a name="l00876"></a>00876             <span class="comment">/* It is hard to control it here.</span>
<a name="l00877"></a>00877 <span class="comment">            * We can only exponentiate the</span>
<a name="l00878"></a>00878 <span class="comment">            * logarithm and eat the loss of</span>
<a name="l00879"></a>00879 <span class="comment">            * precision.</span>
<a name="l00880"></a>00880 <span class="comment">            */</span>
<a name="l00881"></a>00881             <a class="code" href="struct_math_result__struct.html">MathResult</a> lng;
<a name="l00882"></a>00882             <span class="keywordtype">double</span> sgn;
<a name="l00883"></a>00883             <span class="keywordtype">int</span> stat_lng = LnGammaSgnE(x, &amp;lng, &amp;sgn);
<a name="l00884"></a>00884             <span class="keywordtype">int</span> stat_e   = ExpMultErr(lng.val, lng.err, sgn, 0.0, result);
<a name="l00885"></a>00885             <span class="keywordflow">return</span> MATH_ERROR_SELECT_2(stat_e, stat_lng);
<a name="l00886"></a>00886         }
<a name="l00887"></a>00887     }
<a name="l00888"></a>00888     <span class="keywordflow">else</span>
<a name="l00889"></a>00889     {
<a name="l00890"></a>00890         <span class="keywordflow">return</span> GammaXgtHalf(x, result);
<a name="l00891"></a>00891     }
<a name="l00892"></a>00892 }
<a name="l00893"></a>00893 
<a name="l00894"></a>00894 <span class="keywordtype">int</span> LnFact(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n, <a class="code" href="struct_math_result__struct.html">MathResult</a> * result)
<a name="l00895"></a>00895 {
<a name="l00896"></a>00896   <span class="comment">/* CHECK_POINTER(result) */</span>
<a name="l00897"></a>00897 
<a name="l00898"></a>00898   <span class="keywordflow">if</span>(n &lt;= MATH_SF_FACT_NMAX){
<a name="l00899"></a>00899     result-&gt;val = log(fact_table[n].f);
<a name="l00900"></a>00900     result-&gt;err = 2.0 * MATH_DBL_EPSILON * fabs(result-&gt;val);
<a name="l00901"></a>00901     <span class="keywordflow">return</span> MATH_SUCCESS;
<a name="l00902"></a>00902   }
<a name="l00903"></a>00903   <span class="keywordflow">else</span> {
<a name="l00904"></a>00904     LnGammaE(n+1.0, result);
<a name="l00905"></a>00905     <span class="keywordflow">return</span> MATH_SUCCESS;
<a name="l00906"></a>00906   }
<a name="l00907"></a>00907 }
<a name="l00908"></a>00908 
<a name="l00909"></a>00909 <span class="keywordtype">double</span> LnGamma(<span class="keyword">const</span> <span class="keywordtype">double</span> x)
<a name="l00910"></a>00910 {
<a name="l00911"></a>00911   EVAL_RESULT(LnGammaE(x, &amp;result));
<a name="l00912"></a>00912 }
<a name="l00913"></a>00913 
<a name="l00914"></a>00914 <span class="keywordtype">double</span> Gamma(<span class="keyword">const</span> <span class="keywordtype">double</span> x)
<a name="l00915"></a>00915 {
<a name="l00916"></a>00916   EVAL_RESULT(GammaE(x, &amp;result));
<a name="l00917"></a>00917 }
</pre></div></div>
</div>

<p class="update">Last updated: February 8, 2011</p>

</div>
</div>

<div id="footer">
<p><a href="../../../../accessibility.html" title="Accessibility">Accessibility</a> | <a href="../../../../copyright.html" title="Copyright Information">Copyright Information</a></p>
</div>

</div>

</body>
</html>
